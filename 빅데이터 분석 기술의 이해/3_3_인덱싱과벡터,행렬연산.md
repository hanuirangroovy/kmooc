# 3. R 기본 데이터 구조 및 함수



# 3-3. 인덱싱과 벡터, 행렬연산



## 인덱스

- 인덱스란 데이터 객체의 부분을 나타내는 번호나 이름.
- []를 사용하여 표현.
- 인덱싱 : 인덱스를 이용하는 것.



## 벡터의 인덱싱

- []를 사용.

- 벡터 인덱스 활용 : 벡터의 일부분을 선택할 경우. (subset을 구성할 경우)

  ex) 길이 5인 벡터X

  - x[2] : 벡터 x의 2번째 요소.
  - x[c(1,3,5)] : 벡터 x의 첫째, 셋째, 다섯째 요소.
  - x[-3] : 벡터 x의 3번째 요소 제외시킴.
  - x[6] 범위를 초과할 경우 : NA가 출력. (not available)
  - 양수 인덱스 : 해당 요소 선택.
  - 음수 인덱스 : 해당 요소를 제외한 나머지 선택.

- NaN : not a number(분모가 0인 경우와 같이 불가능한 수를 표시)

- is.na() : 그것이 우리가 사용할 수 없는 상태인지 물어보는 것.

  

## 행렬의 인덱싱

- 행렬의 인덱스 (대괄호 안에 행과 열을 구분하여 넣기!)

  ex) 행렬 M에서

  - M[i,j] : i번째 행과 j번째 열의 요소.
  - M[i,] : i번째 행 전부를 말함.
  - M[,j] : j번째 열 전부를 말함.



## 데이터프레임의 인덱싱

- 데이터프레임을 구성하고 있는 하부 구성요소 중 하나를 선택할 경우.

  - 대괄호를 겹쳐 쓰고 그 안에 첨자 혹은 부여된 이름을 지정하거나 $ 기호를 사용.
  - ex) DF[[1]]

- R에서 데이터프레임은 중요한 구조.

  - 대부분의 R함수의 실행결과들이 데이트프레임 형태로 제공되기 때문.

- 데이터프레임을 구성하고 있는 열(변수)들 중 일부 선택.

  - 열의 위치(인덱스) 이용하거나 열 이름 이용.

- 하나의 변수를 선택하는 경우.

  - M[[2]] : 대괄호를 겹쳐 사용하면 하나의 변수를 선택할 때 사용, 벡터로 출력.

    데이터프레임의 두 번째 객체를 선택.

  - M[1] : 하나의 대괄호 사용할 경우 그 결과가 데이터프레임이 됨.

    데이터프레임의 첫번째 객체를 선택.

  - 열이름 사용 가능.

    M[["age"]] 혹은 M&age

  - 데이터프레임이름$변수이름

- 여러 개의 변수를 선택하는 경우.

  - 데이터프레임도 행렬처럼 2차원 구조임.
  - 행렬의 인덱싱방법 사용가능.
  - M[,1] : 데이터프레임의 첫째 열 선택.
  - M[,c(1,3)] : 데이터프레임의 첫째 열과 셋째 열을 선택.
  - M[c(2,3),] : 데이터프레임의 둘째 행과 셋째 행을 선택.

- 열(즉 변수)의 선택. - indexing

  - D[[1]] : 하나의 열을 선택할 때 사용, 벡터로 출력.

  - D[1] : 데이터프레임 생성, 여러 개의 변수를 선택할 때도 하나의 대괄호만을 사용.

    변수이름을 사용할 수도 있음.

  - D[["x"]] : 대괄호 겹쳐 써서 하나의 서브젝트 순서를 지칭.

  - D["x"] : 대괄호 하나에 첫 번째 오브젝트를 요구하는 인덱싱 쓸 수 있음.

- 여러 개의 변수를 선택할 경우.

  - D[c(1,3)] : 변수 인덱스 사용.
  - D[c("x","r")] : 변수이름 사용.

- indexing

  - D[,1] : 1열 선택.
  - D[,C(1,3)] : 1열과 3열 선택.



## 벡터연산

- 벡터 요소 추가

```
y<-c(y,11:15)     #새로운 요소 추가하는 명령. ,를 쓰고 추가하고자 하는 리스트 작성.

y

[1] 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15

x[length[x]+1]=9    #length함수 이용하면 x[length]에 하나 더 더한 인덱스를 이용하여 값 추가.
```



- 벡터들의 연산 : 두 벡터의 연산은 구성 요소단위 끼리의 연산으로 진행.
- 벡터와 상수의 연산 : 벡터와 스칼라의 연산도 구성요소와 스칼라와의 연산으로 진행.
- 벡터의 연산 중 벡터 길이가 다른 경우 짧은 벡터를 반복하여 같은 길이로 구성한 후 연산.



## 벡터연산의 순환법칙, Recycling rule

```
# vector addition
y<-c(1:10)     #1부터 10까지 벡터 주어짐.
y
[1] 1 2 3 4 5 6 7 8 9 10
z<-c(0,1)      #0과 1로 구성된 벡터 z.
z
[1] 0 1
y+z
[1] 1 3 3 5 5 7 7 9 9 11  #y는 10개의 크기, z는 2개. 길이가 짧은 벡터z를 10개의 벡터로 반복구성한
>                          다음 두개의 연산. 0 1 0 1.... 같은 것들이 10개있고 더해짐.

- 반복구성이 곤란한 경우(벡터길이가 배수가 안되는 경우) 경고메시지 발생.
```



## 행렬연산

- 행렬연산자

| 연산자 및 함수  |                   기능                    |
| :-------------: | :---------------------------------------: |
|    + = * / ^    |     행렬을 구성하는 숫자 각각에 적용      |
|      A%*%B      |           행렬 A와 B의 곱하가ㅣ           |
| cbind(A,B,,,,)  |      행렬이나 벡터를 열 단위로 결합       |
|   colMeans(A)   |   행렬 A 각 열의 평균값으로 구성된 벡터   |
|  crossprod(A)   |              t(A)%*%A(A^TA)               |
| crossprod(A,B)  |              t(A)%*%B(A^TB)c              |
|   colSums(A)    |     행렬 A 각 열의 합으로 구성된 벡터     |
|     diag(A)     |    행렬 A의 주대각 원소로 구성된 벡터     |
|     diag(x)     |   행렬 x를 주대각 원소로 하는 대각행렬    |
|     diag(k)     |                k*k단위행렬                |
|    eigen(A)     | 행렬A의 고유값과 고유벡터로 구성된 리스트 |
| rbind(A,B,,,,)  |      행렬이나 벡터를 행 단위로 결합       |
|   rowMeans(A)   |   행렬 A 각 행의 평균값으로 구성된 벡터   |
|   rowSums(A)    |     행렬 A 각 행의 합으로 구성된 벡터     |
|    solve(A)     |              행렬 A의 역행렬              |
|   solve(A,b)    |           연립방정식 Ax=b의 해            |
|      t(A)       |             행렬A의 전치(A^T)             |
|  tcrossprod(A)  |                 A%*%t(A)                  |
| tcrossprod(A,B) |                 A%*%t(B)                  |



- 행렬구성 함수의 이해

  - cbind() : 벡터들을 열단위로 행렬 구성.

  - rbind() : 벡터들을 행단위로 행렬구성.

    ex) A=cbind(x1,x2,x3), B=rbind(x1,x2,x3)

  - 벡터들의 길이가 서로 다른 경우 순환법칙이 적용되어 처리됨.

    ex) x1<-c(1,2,3,4), x2<-c(4,5),x3<-7

    ​	cbind(x1,x2,x3)

- 행렬연산의 중요성
  - 선형대수학 문제 뿐만 아니라 통계분석에서도 아주 유용.
  - (대부분의 통계분석은 데이터 행렬을 사용함)
- 곱셈
  - 대응되는 요소 끼리의 곱셈
  - 행렬의 곱셈 M%*%M
- 교차곱
  - crossprod(A) : A%*%t(A), A'A
  - crossprod(A,B) : A%*%t(B), A'B
- 행렬치환
  - t(A)
- 유용한 함수
  - colMeans() : 행렬 A의 열의 평균으로 구성된 벡터. 
  - colSums(A) : 행렬 A의 열의 합으로 구성된 벡터.
  - rowMeans() : 행렬 A의 행의 평균으로 구성된 벡터.
  - rowSums() : 행렬 A의 행의 합으로 구성된 벡터.



## 대각행렬과 대각원소

- diag(x) : 벡터 x를 대각원소로 하는 대각행렬 생성.

- diag(A) : 행렬 A의 대각원소로 구성된 벡터.

- diag(상수) : 상수*상수 단위행렬 생성.

  ex) D=diag(3) : 3*3 단위 행렬 만들기.



## 행렬식 구하기

```
det(A) : 행렬식

A = (a b)       # 2by2
    (c d)
|A| = |a b| = ad-bc
      |c d|
det(A)
```



## 역행렬, 고유값 구하기

- solve(A) : 역행렬 구하기.
- eigen(A) : 고유값과 고유벡터 구하기.
  - Ax = Γx
- 고유값과 고유벡터 : 행렬 A에 대하여 위 식을 만족하는 벡터 x와 상수 Γ