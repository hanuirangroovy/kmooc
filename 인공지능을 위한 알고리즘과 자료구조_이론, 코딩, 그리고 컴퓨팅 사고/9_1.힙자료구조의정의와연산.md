# 9. 힙 자료구조

## 9-1. 힙 자료구조의 정의와 연산

### binary heap

- binary tree의 일종

- 정의
  - binary tree가 min heap이 되려면 binary tree의 루트 노드가 이 트리내의 다른 모든 값들보다 작아야함
  - 각각의 sub-tree를 봤을 때, sub-tree의 루트도 자손들보다 무조건 값이 작아야 함
  - 이것을 만족하는 binary tree를 binary min heap이라고 부름.
  - max hepa의 경우 루트노드가 자식노드들보다 값이 클 때, binary tree를 max heap이라고 부름
  - 노드가 하나밖에 없는 트리, 빈 트리가 있으면 이것자체로 min heap 
  - 어떤 트리를 루트노드를 잡고 왼쪽 서브트리, 오른쪽 서브트리로 나눴을 때, 각각이 서브트리의 루트노드가 다른 값들보다 더 작을 때, 이 binary tree를 min heap이라고 부름
  - min heap의 특징에는 전체 min heap의 루트노드 혹은 서브트리의 루트노드가 다른 루트노드의 자손보다 작다는 관계가 있다는 거지 sibling끼리는 어떤 정해진 관계성이 존재하지 않음.
- Operations
  - binary heap에서 우리가 어떤 오퍼레이션을 수행할지를 보면 크게 세 가지가 있음
    - Top
      - 가장 작은 값
      - 만약 max heap같은 경우는 가장 큰 값을 찾아오면 top operation이 있음
    - Pop
      - 루트테 있는 값을 제거하는 것
    - Push
      - 어떤 임의의 값을 가지고 있는 binary heap에 binary min heap이든 max heap이든 삽입하는 것.
- Binary Heap : Top
  - min heap에서는 가장 작은 값. 혹은  max heap같은 경우에는 가장 큰 값을 찾아내는 경우에는 constant 타임에 가능
  - 가장 작은 값은 이미 루트노드에 위치해있기 때문에 우리가 top오퍼레이션에서 해야 되는거는 그냥 루트노드를 접근하는 것. 그래서 constant 타임에 가능
- Binary Heap : Pop
  - min heap에서 일반적으로 힙에서는 무언가를 제거할 때 반드시 루트노드에 있는 값을 제거
  - 우리가 min heap에서 가장 작은 오브젝트를 제거한다는 것은 결국 루트노드를 제거한다는 말이고 루트노드가 삭제되고 나면 어떤 노드의 다른 값이 루트노드로 올라와야 되는데 이 값은 제거한 루트노드의 제외한 값들 중에 가장 작은 값이 루트노드로 올라와야 될 것.
  - 만약 어떤 값이 루트노드로 이동했다하면 그 자리가 왼쪽 서브트리든 오른쪽 서브트리든  둘 중 하나는 빈자리가 됨. 여기를 채워주는 게 밑에서 위로 올라와서 채우는 과정이라서 promotion이라고 얘기함.
- Binary Heap : Push
  - 뭔가를 삽입하는데 트리 중앙에 갑자기 삽입하는 것은 이상하니까 leaf 노드에다 아이템을 삽입해서 적당한 위치로 올라가게끔 만드는 방법도 있고 혹은 루트 노드에 삽입해서 루트노드를 밑으로 강등시킨 다음에 삽입하는 방법도 있음
  - leaf 노드에 아이템을 삽입하는 방법을 택한다면 binary min heap이 아니라 다른 heap같은 경우에 루트노드에 삽입하는 경우도 있는데 binary min heap 같은 경우 leaf 노드에 삽입하는 것이 일반적이기 때문에 leaf 노드에 새로운 아이템을 push하는 것을 기준으로 두고 함.
    - 예를 들면 바이너리 min heap 에서 17을 삽입하겠다고 하면 이 17을 그냥 아무 leaf노드에 그냥 17을 일단 넣어줌
    - 그러면 32가 루트인 작은 서브트리 혹은 31이 루트인 서브트리 혹은 19가 루트인 서브트리가 모두 binary min heap의 조건에 만족하지 못함
    - 19가 루트인 서브트리를 생각했을 때 이 서브트리에서 19가 최소값이 되야 하는데 현재 19이 19보다 더 작기 때문에 왼쪽 서브트리가 19가 루트인 서브트리는 현재 binary min heap을 만족하지 않음
    - 여기서 할 수 있는 것은 앞을 삭제 한 후에 위로 promotion하는 것처럼 17이 올바른 자리로 갈수 있도록 해주는 것
    - 그래서 17을 부모인 32와 비교해서 17이 더 작기에 둘의 자리를 바꿔줘야 함. 
    - 이와 같은 과정을 거쳐서 새로운 아이템을 가지고 있는 binary min heap에 추가할 수 있음
  - 그래서 우리가 삽입을 하는 경우에 보면 어떤 leaf 노드에 삽입된 노드는 항상 위로 올라가지 절대 아래로 내려오는 경우가 없음. 그래서 이 과정을 percolation이라고도 부름

