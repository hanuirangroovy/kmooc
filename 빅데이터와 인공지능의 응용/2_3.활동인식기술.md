# 2주차. 인간 행동 탐지 및 응용➀

## 2-3. 활동 인식 기술

- Activity Recognition
  - 사용자의 신체활동을 알아내는 기술
  - daily / weekly activity profile 을 만드는 데 활용할 수도 있고 전화기에 configuration 하는데도 활용할 수 있음
- 분류문제
  - 데이터가 왔을 떄 이 데이터가 과연 어떤 액티비티 타입에 해당하는 것인지 알고 싶은 것
- 탐지 vs 분류
  - 탐지 (Detection)
    - 시그널의 특성을 일일이 분석해 딱 맞는 알고리즘을 만들어내는 게 가능
  - 분류 (Classification)
    - 다루어야될 액티비티의 종류가 굉장히 많아 종류별로 알고리즘을 만든다는 게 쉽지 않기에 이렇게 접근보다는 기계학습 방식을 활용하여 분류 문제를 접근

- How to Classify Activities?
  - 2.5초 정도의 데이터가 있을 때 이 데이터가 sitting, standing, walking, jogging 4가지만 있다고 가정.
  - 4개 중 어떤 활동에 해당하는지를 알고자 하며 이게 문제의 상황
  - step count 에서 했던 대로 시그널 특성을 살펴보고 그 특성을 반영하는 방법을 생각해보고 우선 각각에 해당하는 Acceleration Signal을 살펴봄
  - walking에서 보이는 경우보다 jogging은 피키의 횟수가 더 자주 나타남
  - standing과 sitting 비교하면 둘 다 시그널이 굉장히 진폭이 적고 일정한 값으로 나오게 되지만 시그널의 값은 0이 아님
  - standing의 경우 Y축 방향으로 중력이 존재하기에 그 값에 해당하는 가속이 나타남. 정확히 밑에 방향을 보고 있지 않은 이유도 있고 가만히 있다고해서 꼭 0의 값이 나오지는 않음. 캘리브레이션이 안 되기 때문에 0의 값이 정확히 나오지 않고 다른 축도 0 근처의 값들이 나오게 됨
  - sitting의 경우 스마트폰에 가장 중력이 크게 작용하는 방향이 Z축이게 됨. Z축 방향으로 중력가속도가 가장 크게 나타나게 되고 나머지 축으로도 중력가속도를 나눠갖기 때문에 나머지 축도 positive한 값들이 나오게 됨
- A Simple Heuristic?
  - Y axis 방향의 데이터들의 표준편차라는 건 데이터가 얼마나 넓게 퍼져있는 가이기에 fluctuation이 많을 때 표준편차가 크게 나타남. 그렇기에 Y axis 값의 표준편차가 작으면 standing이나 sitting 중에 하나일 것
  - standing과 sitting은 중력가속도 방향이 standing은 Y축, sitting은 Z축이 크게 나타나기에 중력가속도 방향을 이용해서 Y axis값이 어느 정도 이상이 되면 standing, 이 값이 어떤 값 미만으로 줄어들면 sitting으로 구별
  - walking과 jogging은 푸리에 트랜스폼을 시그널에 돌리게 되면 이 시그널에 가장 dominant한 프리퀀시가 나오게 되고 walking 의 경우 dominant 프리퀀시 값이 jogging의 경우보다 더 작은 값으로 나오게 됨. 그래서 Threshold들을 잘 설정하게 되면 FFT를 통해 walking과 jogging을 구별해 낼 수 있음
- Problems of Heuristics
  - activity의 종류가 굉장히 많아진다면 이런 종류의 분류 방법을 다수의 activity에 대해 생각해내기 쉽지 않음
  - STDEV가 MAX보다 낫을지 정확히 알기가 어려움
  - 어디에 위치하느냐에 따라 굉장히 시그널이 다르게 나오게 됨
  - 다른 상황에 적용됐을 때 과연 동작할 것인가
  - 이 문제를 해결하기 위해서는 Heuristics을 우리가 시그널을 정말 세밀하게 분석하고 더 많은 상황에 대해서 다 분석을 해가지고  Heuristics 최대한 보강
- Machine Learning Techniques
  - 기계 학습 기술 : 시그널을 통해서 특징값들을 뽑고 이런 특징값을 활용해 자동으로 알고리즘 만들어줌
  - 알고리즘을 통해 새로운 Acceleration Signal이 왔을 때 어디에 속하는지 알려주게 됨
- STEP 1 : Labeled Data Collection
  - 데이터를 모아야함
  - 데이터를 모으는데 있어서 가장 어려운 점은 레이블링을 해야된다는 것
  - 비지도 학습 방식도 있지만 분류 문제에 있어서는 지도학습 방식을 많이 씀
  - 지도학습 : 모델을 학습시킬 때 이 데이터가 어떤 그라운드 트루스에 해당한다는 것 알려줘야 함
  - 레이블링된 데이터를 많이 모아 탐지하고자 하는 액티비티 카테고리별로 많이 모아야 함. 탐지하고자 하는 모든 액티비티에 대해 충부난 양의 데이터를 갖춰야 함
- STEP 2 : Feature Extraction
  - 데이터로부터 유의미한 특징값을 뽑아내야 하고 이 과정은 머신러닝 알고리즘이 어느 정도 자동으로 해주지만 프로그래머의 수동적인 개입이 여전히 중요한 과정
  - 인사이트를 어느 정도 가지고 이런 피쳐들을 모델에서 활용해야 된다라는 거를 지정해줘야함
  - 피쳐 종류
    - Time-domain features : 윈도우를 적용해 그 안에서 요약값 뽑아내기
    - Frequency domain features : time-domain features를 FFT를 통해 프리퀀시도메인으로 바꾸거 거기서 나오는 정보들이 프리퀀시도메인 피처가 됨
  - Feature Extraction에서 많이 하는 방법은 활용할 수 있는 모든 피쳐를 다 뽑아서 학습 알고리즘에 넣고 학습 알고리즘이 좋은 피쳐를 뽑아주는 것
  - 굉장히 다수의 피쳐를 뽑아 학습기에 넣고 플터들을 좋은 거 나쁜 거 구별해가지고 좋은 거 위주로 활용할 것이다 생각할 수 있지만 너무 많은 피쳐를 넣게 되면 학습과정에서 학습기가 완벽한 것들이 아니기에 혼돈을 가져오게 됨
  - 그렇기에 어느 정도 개발자가 피쳐의 수퍼셋을 정의 해 학습기에 좋은 피쳐들 위주로 넘겨주는 과정 필요
- STEP 3 : Choose and Train a Classifier
  - 트레이닝 데이터와 레이블을 주고 다음에 그 피쳐의 수퍼셋을 모델 학습기에 넣게 되면 자동으로 이 레이블들에 있는 액티비티들을 탐지할 수 있는 모델이 생성
  - 새로운 데이터가 왔을 때 데이터를 모델에 적용을 하면 이 데이터가 러닝에 해당하는 건지 워킹에 해당하는 건지 바로 알 수가 있게 됨
- Decision Tree Classifier
  - 가장 간단한 종류의 분류기 중 하나인 디시젼 트리 분류기
  - Decision Tree는 어떤 피쳐를 가지고 양쪽을 나눠야 이 액티비티 카테고리를 잘 구별해줄 수 있을까 등을 자동으로 결정
  - Decision Tree 의 피쳐와 데이터, 레이블을 넣게 되면 가장 중요한 피쳐부터 시작해서 맨 위에 루트에서 그 값들을 나누게 됨
  - meanH라는 값이 어떤 Threshold 미만일 때 이 쪽에 sitting이나 standing  카테고리가 되게 되고 나머지는 움직이는 카테고리가 됨 
  - 그 안에서도 어떤 값을 기준으로 드라이빙과 이걸 구별하게 되고 점점 특정 피쳐와 Threshold를 가지고 액티비티를 점점 세분화해서 구별해나가는 과정을 겪게 됨 
  - 휴리스틱과의 가장 큰 차이 :  어떤 피쳐를 루트에 두고 그다음에 어떤 피쳐를 쓰고 그다음에 어떤 피쳐를 쓰고 이걸 자동으로 결정한다는 것. 그리고 이 피쳐에서 이 액티비티들을 나누기 위해 어떤 Threshold 값을 활용해야 되냐도 자동으로 결정해 주게 된다는 것
  - 그래서 디시젼 트리가 어떻게 보면 Heuristics이랑 비슷하다고 생각할 수 있지만 가장 큰 차이는 이 트리가 데이터를 기반으로 학습이 돼서 나온다라는 것임
- How to Build the Decision Tree?
  - 사실 모델별로 그 빌드하는 과정이 모델이 어떤 식으로 학습된다라는 거를 알면 그 모델에 어떤 경우에 이 모델을 잘 활용할 수 있는지 혹은 이 모델의 단점인지를 어떤 건지를 알 수 있게 됨
- Activity Recognotion
  - 피쳐가 100개가 있다 그러면 이 100개 중에서 어떤 피쳐가 어떤 피쳐를 선택했을 때 이 인포메이션 게인이 가장 큰지 즉 액티비티를 가장 잘 나눌 수 있는지를 보게 됨.
  - 인포메이션 게인이 가장 큰 피쳐를 제일 위에다 놔가지고 액티비티를 크게 두 분류로 나누게 되고 그 다음 중요한 피쳐를 그 밑에다 두고 그다음 중요한 피쳐를 이 밑에다 두고 이거를 리컬시브하게 계속 거쳐가면서 중요한 피쳐부터 덜 중요한 피쳐까지 이렇게 액티비티를 구별하는 과정을 쭉 거치게 됨.
  - 액티비티 레코그니션,  클래시피케이션은 굉장히 많은 연구가 진행이 돼왔고 커머셜한 애플리케이션도 나오고 있지만 여전히 이거는 온 고잉 리서치 토픽
  - 흔히 일상에서 일어나는 움직임에 대한 액티비티를 볼 때 더 세분화 해가지고 사람들이 하는 굉장히 세분화된 활동들을 어떻게 하면 탐지할 수 있을까 이런 거에 대해서 연구가 이뤄지고 있고, 어떤 센서, 어떤 모델, 어떤 알고리즘을 써서 탐지를 해야지 정확도를 높일 수 있을까 연구, 이런 거는 흔히 모바일이나 IOP 같은 장비에서 돌아가기 때문에 이런 작은 장비에서 머신러닝을 어떻게하면 효과적으로 효율적으로 돌릴 수 있을지 연구 
- A Couple of Ideas
  - 한 가지 아이디어는 더 잘하고 정확도를 높이기 위해 센서를 굉장히 여러 군데에 있는 센서를 쓰는 것
    - 액티비티의 종류에 따라서 여러 위치에 존재하는 센서들을 퓨전해가지고 사용하는 이런 아이디어들이 많이 나오고 있음
  - 또 한 가지는 딥러닝이 뜨면서 딥러닝 기법을 활용한 그런 기술들도 많이 나오고 있음
    - 아이디어를 설명하자면 전에 데이터가 러닝, 시팅, 스탠딩, 워킹에 대해서 비쥬얼리 구별 됨
    -  신경써서 보면 비쥬얼리 데이터들이 차이가 난다는 것을 볼 수 있음. 이 데이터를 시간축상에서 비쥬얼라이션 해놓고 CNN 같은 이미지를 굉장히 잘 인식할 수 있는 모델을 돌리면 액티비티를 구별해낼 수 있지 않을까라는 아이디어를 가지고 연구 진행
    - 이런 딥러닝 기반의 액티비티 탐지 기술이 최근들어서 기존의 쉘로우 모델 기반 피쳐를 뽑고 그 피쳐 기반에서 모델을 만들고 인식하는 알고리즘에 대비해서 성능이 더 좋다는 사실이 밝혀지고 있음

## QUIZ

1. 모바일 기기는 주로 무선 네트워크에 연결되어 사용된다.
2. 모바일 환경은 기존(tradition)과는 다른 새로운 형태의 operational model을 제공한다. 예를 들어, 기존의 모바일/IoT 서비스들은 작은 디스플레이, 사용자의 이동성 등을 고려하여 단일 사용자와 소통하는 형태의 애플리케이션들이 주를 이뤘다. 이와 달리, AI기술에 기반한 최근의 서비스들은 자동적으로 상황을 인지해야 하기 때문에 백그라운드에서 동시적인 센싱과 추론을 하는 것이 응용의 주요 기반이 된다.
3. 활동 인식(Activity recognition) 기술은 classification 방식의 일종이다. (O)

2. 노이즈 제거를 위한 전처리 방법 중 윈도우 크기가 그 성능에 큰 영향을 미치는 방법은? (Moving average smoothing)

3. 활동 인식(Activity recognition)에서는 별도의 detection 알고리즘이 존재하지 않는다.